

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>The Variable-Density Incompressible Navier-Stokes Equations &mdash; IAMR 21.08-dev documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"macros": {"Ab": "{{\\bf A}}", "eb": "{{\\bf e}}", "Fb": "{{\\bf F}}", "gb": "{{\\bf g}}", "Hb": "{{\\bf H}}", "ib": "{{\\bf i}}", "Ib": "{{\\bf I}}", "Kb": "{{\\bf K}}", "lb": "{{\\bf l}}", "Lb": "{{\\bf L}}", "nb": "{{\\bf n}}", "Pb": "{{\\bf P}}", "Qb": "{{\\bf Q}}", "rb": "{{\\bf r}}", "Rb": "{{\\bf R}}", "Sb": "{{\\bf S}}", "ub": "{{\\bf u}}", "Ub": "{{\\bf U}}", "xb": "{{\\bf x}}", "dt": "{\\Delta t}", "omegadot": "{\\dot\\omega}", "inp": "{{\\rm in}}", "outp": "{{\\rm out}}", "sync": "{{\\rm sync}}", "half": "{\\frac{1}{2}}", "myhalf": "{\\half}", "nph": "{{n+\\myhalf}}", "vb": "{\\boldsymbol{v}}", "vbt": "{\\widetilde{\\vb}}", "rbt": "{\\widetilde{\\rb}}", "ob": "{\\boldsymbol{\\omega}}", "nablab": "{\\boldsymbol{\\nabla}}", "avg": ["{{\\left \\langle #1 \\right \\rangle}}", 1]}}}</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Getting Started" href="Getting_Started.html" />
    <link rel="prev" title="Introduction" href="Introduction_Chapter.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> IAMR
          

          
          </a>

          
            
            
              <div class="version">
                21.08-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="Introduction_Chapter.html">Introduction</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">The Variable-Density Incompressible Navier-Stokes Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#brief-overview-of-low-speed-approximations">Brief Overview of Low Speed Approximations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#projection-methods-101">Projection Methods 101</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Getting_Started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Units.html">Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="Software_Chapter.html">Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visualization_Chapter.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Inputs_Chapter.html">Run-time Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="ManagingGridHierarchy_Chapter.html">Gridding and Load Balancing</a></li>
<li class="toctree-l1"><a class="reference internal" href="AMR.html">AMR</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parallel.html">Parallelization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fluids_Chapter.html">Solving the Fluid Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="EB.html">Embedded Boundaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="Particles_Chapter.html">Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="Debugging.html">Debugging</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">IAMR</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="Introduction_Chapter.html">Introduction</a> &raquo;</li>
        
      <li>The Variable-Density Incompressible Navier-Stokes Equations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/Introduction.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="the-variable-density-incompressible-navier-stokes-equations">
<h1>The Variable-Density Incompressible Navier-Stokes Equations<a class="headerlink" href="#the-variable-density-incompressible-navier-stokes-equations" title="Permalink to this headline">¶</a></h1>
<p>IAMR solves the variable-density incompressible Navier-Stokes equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
{{\bf U}}_t + ({{\bf U}}\cdot\nabla){{\bf U}}&amp;=&amp; \frac{1}{\rho}(-\nabla p + \mu\nabla^2 {{\bf U}}+ {\bf H}_U), \\
\rho_t + \nabla\cdot(\rho {{\bf U}}) &amp;=&amp; 0, \\
c_t + ({{\bf U}}\cdot\nabla)c &amp;=&amp; k\nabla^2 c + H_c, \\
\nabla\cdot {{\bf U}}&amp;=&amp; 0,\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\({{\bf U}}= (u, v, w), \rho, c\)</span>, and <span class="math notranslate nohighlight">\(p\)</span> represent the velocity, density, concentration of an
advected scalar, and pressure, respectively, and <span class="math notranslate nohighlight">\({\bf H}_U = (H_x , H_y , H_z )\)</span> represents any external
forces. Here <span class="math notranslate nohighlight">\(\mu\)</span> is the dynamic viscosity coefficient, <span class="math notranslate nohighlight">\(k\)</span> is the diffusive coefficient for <span class="math notranslate nohighlight">\(c\)</span>, and
<span class="math notranslate nohighlight">\(H_c\)</span> is the source term for <span class="math notranslate nohighlight">\(c\)</span>. In general one could advect an arbitrary number of scalars,
either passively or conservatively.</p>
</section>
<section id="brief-overview-of-low-speed-approximations">
<h1>Brief Overview of Low Speed Approximations<a class="headerlink" href="#brief-overview-of-low-speed-approximations" title="Permalink to this headline">¶</a></h1>
<p>The IAMR code can also used as a basis for more
general low Mach number flow algorithms (e.g., low Mach number combustion,
low Mach number astrophysics, porous media flow)
There are many low speed formulations of the equations of hydrodynamics
in use, each with their own applications. All of these methods share in
common a constraint equation on the velocity field that augments the
equations of motion.</p>
<p>The simplest low Mach number approximation is incompressible
hydrodynamics. This approximation is formally the <span class="math notranslate nohighlight">\(M \rightarrow 0\)</span>
limit of the Navier-Stokes equations. In incompressible hydrodynamics,
the velocity satisfies a constraint equation:</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot {{\bf U}}= 0\]</div>
<p>which acts to instantaneously equilibrate the flow, thereby filtering
out soundwaves. The constraint equation implies that</p>
<div class="math notranslate nohighlight">
\[D\rho/Dt = 0\]</div>
<p>(through the continuity equation) which says that the density is
constant along particle paths. This means that there are no
compressibility effects modeled in this approximation.</p>
</section>
<section id="projection-methods-101">
<h1>Projection Methods 101<a class="headerlink" href="#projection-methods-101" title="Permalink to this headline">¶</a></h1>
<p>We include a brief discussion of projection methodology for
incompressible and low Mach number flow.
The compressible Navier-Stokes equations can be written in the form:</p>
<div class="math notranslate nohighlight">
\[{{\bf U}}_t + \nabla \cdot F({{\bf U}}) = S\]</div>
<p>where <span class="math notranslate nohighlight">\({{\bf U}}\)</span> is a vector of conserved quantities, <span class="math notranslate nohighlight">\({{\bf U}}= (\rho, \rho u,
\rho E)\)</span>, with <span class="math notranslate nohighlight">\(\rho\)</span> the density, <span class="math notranslate nohighlight">\(u\)</span> the velocity, <span class="math notranslate nohighlight">\(E\)</span> the total
energy per unit mass, and <span class="math notranslate nohighlight">\(S\)</span> are source terms. This system
can be expressed as a coupled set of advection/diffusion equations:</p>
<div class="math notranslate nohighlight">
\[{\bf q}_t + A({\bf q}) \nabla {\bf q} + D = {\cal S}\]</div>
<p>where <span class="math notranslate nohighlight">\({\bf q}\)</span> are called the primitive variables, <span class="math notranslate nohighlight">\(A\)</span> is the advective
flux Jacobian, <span class="math notranslate nohighlight">\(A \equiv \partial F / \partial U\)</span>, <span class="math notranslate nohighlight">\(D\)</span> are diffusion terms,
and <span class="math notranslate nohighlight">\({\cal S}\)</span> are the transformed sources. The eigenvalues of the
matrix <span class="math notranslate nohighlight">\(A\)</span> are the characteristic speeds—the real-valued speeds at which
information propagates in the system, <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(u
\pm c\)</span>, where <span class="math notranslate nohighlight">\(c\)</span> is the sound speed. Solution methods for the
compressible equations that are strictly conservative make use of this wave-nature to compute advective fluxes
at the interfaces of grid cells. Diffusive fluxes can be computed
either implicit or explicit in time, and are added to the advective fluxes,
and used, along with the source terms to update the state in time. An
excellent introduction to these methods is provided by LeVeque’s book
<span id="id1">[<a class="reference internal" href="references.html#id3" title="Randall J LeVeque. Finite volume methods for hyperbolic problems. Volume 31. Cambridge university press, 2002.">7</a>]</span>. The timestep for these methods is limited by all three processes
and their numerical implementation. Typically, advection terms are treated
time-explicitly, and the time step will be constrained by the time
it takes for the maximum characteristic speed to traverse one grid cell.
However, in low speed flow applications, it can be shown the acoustics
transport very little energy in the system. As a result, the time-step
restrictions arising from numerical treatement of the advection terms
can be unnecessarily limited, even if A-stable methods are used to incorporate
the diffusion and source terms.</p>
<p>In contrast, solving incompressible or low Mach number systems
typically involves a stage where one or more
advection-like equations are solved (representing, e.g. conservation of mass and
momentum), and coupling that advance with a divergence constraint on the velocity field.
For example, the equations of invicid constant-density incompressible flow
are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
{{\bf U}}_t &amp;=&amp; -{{\bf U}}\cdot \nabla {{\bf U}}- \frac{1}{\rho}\nabla p \label{eq:incompressible_u} \\
\nabla \cdot {{\bf U}}&amp;=&amp; 0\end{aligned}\end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\({{\bf U}}\)</span> represents the velocity vector
and <span class="math notranslate nohighlight">\(p\)</span> is the dynamical pressure. The time-evolution equation for
the velocity (Eq. [eq:incompressible_u]) can be solved using
techniques similar to those developed for compressible hydrodynamics,
updating the old velocity, <span class="math notranslate nohighlight">\({{\bf U}}^n\)</span>, to the new time-level, <span class="math notranslate nohighlight">\({{\bf U}}^\star\)</span>.
Here the “<span class="math notranslate nohighlight">\(^\star\)</span>” indicates that the updated velocity does not, in
general, satisfy the divergence constraint. A projection method will
take this updated velocity and force it to obey the constraint
equation. The basic idea follows from the fact that any vector
field can be expressed as the sum of a divergence-free quantity and
the gradient of a scalar. For the velocity, we can write:</p>
<div class="math notranslate nohighlight">
\[{{\bf U}}^\star = {{\bf U}}^d + \nabla \phi \label{eq:decomposition}\]</div>
<p>where <span class="math notranslate nohighlight">\({{\bf U}}^d\)</span> is the divergence free portion of the velocity vector,
<span class="math notranslate nohighlight">\({{\bf U}}^\star\)</span>, and <span class="math notranslate nohighlight">\(\phi\)</span> is a scalar. Taking the divergence of
Eq. ([eq:decomposition]), we have</p>
<div class="math notranslate nohighlight">
\[\nabla^2 \phi = \nabla \cdot {{\bf U}}^\star\]</div>
<p>(where we used <span class="math notranslate nohighlight">\(\nabla \cdot {{\bf U}}^d = 0\)</span>).
With appropriate boundary conditions, this Poisson equation can be
solved for <span class="math notranslate nohighlight">\(\phi\)</span>, and the final, divergence-free velocity can
be computed as</p>
<div class="math notranslate nohighlight">
\[{{\bf U}}^{n+1} = {{\bf U}}^\star - \nabla \phi\]</div>
<p>Because soundwaves are filtered, the timestep constraint now depends only
on <span class="math notranslate nohighlight">\(|{{\bf U}}|\)</span>.</p>
<p>Extensions to variable-density incompressible
flows <span id="id2">[<a class="reference internal" href="references.html#id7" title="J. B. Bell and D. L. Marcus. A second-order projection method for variable-density flows. Journal of Computational Physics, 101:334-348, 1992.">5</a>]</span> involve a slightly different
decomposition of the velocity field and, as a result, a slightly
different, variable-coefficient Poisson equation.
There are also a variety of different ways
to express what is being projected <span id="id3">[<a class="reference internal" href="references.html#id13" title="A. S. Almgren, J. B. Bell, and W. Y. Crutchfield. Approximate projection methods: part I. Inviscid analysis. SIAM J. Sci. Comput., 22(4):1139–59, 2000.">2</a>]</span>,
and different discretizations of the divergence and gradient operators
lead to slightly different mathematical properties of the methods
(leading to “approximate
projections” <span id="id4">[<a class="reference internal" href="references.html#id11" title="A. S. Almgren, J. B. Bell, and W. G. Szymczak. A numerical method for the incompressible Navier-Stokes equations based on an approximate projection. SIAM J. Sci. Comput., 17(2):358–369, March 1996.">3</a>]</span>). Finally, for
second-order methods, two projections are typically done per timestep.
The first (the ‘MAC’ projection <span id="id5">[<a class="reference internal" href="references.html#id12" title="J. B. Bell, P. Colella, and L. H. Howell. An efficient second-order projection method for viscous incompressible flow. In Proceedings of the Tenth AIAA Computational Fluid Dynamics Conference, 360–367. AIAA, June 1991.">4</a>]</span>)
operates on the half-time, edge-centered advective velocities, making
sure that they satisfy the divergence constraint. These advective
velocities are used to construct the fluxes through the interfaces to
advance the solution to the new time. The second/final projection
operates on the cell-centered velocities at the new time, again
enforcing the divergence constraint. The IAMR algorithm performs
both of these projections.</p>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Getting_Started.html" class="btn btn-neutral float-right" title="Getting Started" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Introduction_Chapter.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017-2018, IAMR Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>